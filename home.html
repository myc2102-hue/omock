<!DOCTYPE html>
<html lang="ko">
<head>
    <link rel="icon" href="/omock/favicon.ico">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Design Library</title>
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    
    <script src="badwords.js"></script>

    <style>
        /* --- CSS ìŠ¤íƒ€ì¼ ì‹œì‘ --- */
        :root { --primary-color: #2563eb; --brand-orange: #FC5E20; --gradient-text: linear-gradient(135deg, #2563eb 0%, #7c3aed 50%, #db2777 100%); --bg-color: #f8fafc; --text-main: #0f172a; --text-sub: #64748b; }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, system-ui, sans-serif; }
        body { background-color: var(--bg-color); color: var(--text-main); line-height: 1.6; overflow-x: hidden; }
        a { text-decoration: none; color: inherit; }
        header { padding: 15px 40px; display: flex; justify-content: space-between; align-items: center; background: rgba(255, 255, 255, 0.7); backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px); position: sticky; top: 0; z-index: 100; border-bottom: 1px solid rgba(255, 255, 255, 0.5); }
        .logo-area { display: flex; align-items: center; cursor: pointer; }
        .logo-svg { height: 36px; width: auto; display: block; }
        .text-hero { max-width: 800px; margin: 0 auto; padding: 100px 20px 60px 20px; text-align: center; }
        .hero-title { font-size: 3.5rem; font-weight: 800; margin-bottom: 20px; letter-spacing: -1.5px; line-height: 1.1; background: var(--gradient-text); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .hero-subtitle { font-size: 1.25rem; color: var(--text-sub); font-weight: 500; }
        .main-visual-full { width: 100%; height: 600px; background-color: #e0e7ff; background-image: url('https://raw.githubusercontent.com/myc2102-hue/omock/refs/heads/main/mainvisual.jpg'); background-size: cover; background-position: center; background-attachment: fixed; margin-bottom: 80px; position: relative; }
        .visual-overlay { position: absolute; bottom: 0; left: 0; width: 100%; height: 150px; background: linear-gradient(to bottom, rgba(248,250,252,0) 0%, rgba(248,250,252,1) 100%); }
        .container { max-width: 1200px; margin: 0 auto; padding: 0 20px 100px 20px; position: relative; z-index: 10; margin-top: -120px; }
        .section-header-glass { display: inline-flex; align-items: center; margin-bottom: 40px; background: rgba(255, 255, 255, 0.65); backdrop-filter: blur(16px); border: 1px solid rgba(255, 255, 255, 0.4); box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.1); padding: 12px 24px; border-radius: 50px; }
        .section-title { font-size: 1.5rem; font-weight: 700; color: #1e293b; }
        .section-badge { margin-left: 15px; background: rgba(255, 241, 235, 0.8); color: var(--brand-orange); padding: 5px 12px; border-radius: 20px; font-size: 0.85rem; font-weight: 600; }
        .grid-wrapper { display: grid; grid-template-columns: repeat(3, 1fr); gap: 30px; }
        .card { background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(5px); padding: 35px; border-radius: 24px; border: 1px solid rgba(255, 255, 255, 0.5); box-shadow: 0 10px 30px -10px rgba(0, 0, 0, 0.05); transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); cursor: pointer; display: flex; flex-direction: column; align-items: flex-start; }
        .card:hover { transform: translateY(-8px); box-shadow: 0 20px 40px -10px rgba(37, 99, 235, 0.15); border-color: rgba(255, 255, 255, 0.8); background: #ffffff; }
        .icon-box { width: 56px; height: 56px; background: #f1f5f9; color: #475569; border-radius: 16px; display: flex; align-items: center; justify-content: center; margin-bottom: 24px; transition: background 0.3s ease, color 0.3s ease; }
        .icon-box i { font-size: 1.8rem; }
        .card:hover .icon-box { background: #fff7ed; color: var(--brand-orange); }
        .card h3 { font-size: 1.35rem; margin-bottom: 10px; font-weight: 700; color: #1e293b; }
        .card p { color: var(--text-sub); font-size: 0.95rem; line-height: 1.6; word-break: keep-all; }
        footer { text-align: center; padding: 60px 20px; color: var(--text-sub); background: #f1f5f9; font-size: 0.9rem; border-top: 1px solid #e2e8f0; }
        
        /* ì±„íŒ… ìœ„ì ¯ CSS */
        .chat-launcher { position: fixed; bottom: 30px; right: 30px; width: 60px; height: 60px; background: var(--primary-color); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 30px; box-shadow: 0 8px 20px rgba(37, 99, 235, 0.4); cursor: pointer; z-index: 9999; transition: transform 0.3s ease, background 0.3s ease; }
        .chat-launcher:hover { transform: scale(1.1); background: #1d4ed8; }
        .notification-badge { position: absolute; top: -5px; right: -5px; background-color: #ef4444; color: white; font-size: 0.75rem; font-weight: bold; width: 24px; height: 24px; border-radius: 50%; display: flex; align-items: center; justify-content: center; border: 2px solid white; opacity: 0; transform: scale(0); transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        .notification-badge.show { opacity: 1; transform: scale(1); }
        .chat-tooltip { position: fixed; bottom: 40px; right: 100px; background: white; color: #334155; padding: 10px 16px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); font-size: 0.9rem; font-weight: 600; z-index: 9998; opacity: 1; transform: translateX(0); transition: all 0.3s ease; pointer-events: none; white-space: nowrap; }
        .chat-tooltip::after { content: ''; position: absolute; right: -6px; top: 50%; transform: translateY(-50%); border-width: 6px 0 6px 8px; border-style: solid; border-color: transparent transparent transparent white; }
        .chat-tooltip.hidden { opacity: 0; transform: translateX(10px); }
        .chat-container { position: fixed; bottom: 100px; right: 30px; width: 360px; height: 500px; background: rgba(255, 255, 255, 0.95); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.8); border-radius: 20px; box-shadow: 0 15px 40px rgba(0,0,0,0.15); display: none; flex-direction: column; z-index: 9999; overflow: hidden; opacity: 0; transform: translateY(20px); transition: opacity 0.3s ease, transform 0.3s ease; }
        .chat-container.active { display: flex; opacity: 1; transform: translateY(0); }
        .chat-header { background: var(--primary-color); color: white; padding: 15px 20px; display: flex; justify-content: space-between; align-items: center; font-weight: 600; }
        .chat-status { font-size: 0.85rem; background: rgba(255,255,255,0.2); padding: 4px 10px; border-radius: 12px; display: flex; align-items: center; gap: 5px; }
        .chat-close-btn { cursor: pointer; font-size: 1.2rem; }
        .chat-body { flex: 1; padding: 20px; overflow-y: auto; background: #f8fafc; display: flex; flex-direction: column; gap: 10px; }
        .login-screen { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: white; z-index: 10; display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 30px; text-align: center; }
        .login-screen.hidden { display: none; }
        .login-input { width: 100%; padding: 12px; margin: 15px 0; border: 1px solid #cbd5e1; border-radius: 8px; font-size: 1rem; }
        .join-btn { background: var(--primary-color); color: white; border: none; padding: 12px 30px; border-radius: 8px; font-weight: 600; cursor: pointer; width: 100%; }
        .message { max-width: 80%; padding: 10px 14px; border-radius: 14px; font-size: 0.95rem; line-height: 1.4; position: relative; animation: fadeIn 0.3s ease; word-break: break-all; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
        .message.my-msg { background: var(--primary-color); color: white; align-self: flex-end; border-bottom-right-radius: 2px; }
        .message.other-msg { background: white; color: #334155; align-self: flex-start; border-bottom-left-radius: 2px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
        .message-info { font-size: 0.75rem; margin-bottom: 4px; opacity: 0.8; display: block; }
        .chat-footer { padding: 15px; background: white; border-top: 1px solid #e2e8f0; display: flex; gap: 10px; }
        .chat-input { flex: 1; padding: 10px; border: 1px solid #cbd5e1; border-radius: 20px; outline: none; }
        .send-btn { background: transparent; border: none; color: var(--primary-color); font-size: 1.5rem; cursor: pointer; display: flex; align-items: center; }
        
        @media (max-width: 768px) {
            .grid-wrapper { grid-template-columns: 1fr !important; }
            .chat-container { width: 90%; right: 5%; bottom: 100px; height: 60vh; }
            .chat-tooltip { right: 80px; bottom: 45px; font-size: 0.8rem; }
            .hero-title { font-size: 2.2rem; }
            .text-hero { padding: 60px 20px 40px 20px; }
            .main-visual-full { height: 350px; margin-bottom: 40px; }
            header { padding: 15px 20px; }
            .logo-svg { height: 28px; }
            .container { margin-top: 0; padding-top: 0; } 
            .section-header-glass { width: 100%; justify-content: space-between; margin-bottom: 20px;}
        }
        @media (max-width: 1024px) {
            .grid-wrapper { grid-template-columns: repeat(2, 1fr); }
            .hero-title { font-size: 2.8rem; }
            .main-visual-full { height: 500px; background-attachment: scroll; }
            .container { margin-top: -60px; }
        }
    </style>
</head>
<body>

    <header>
        <a href="#" class="logo-area">
            <svg class="logo-svg" viewBox="0 0 800 200" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M191.797 43.0686L150.793 157.26H174.807L182.322 135.532H227.737L235.252 157.26H259.43L218.425 43.0686H191.797ZM188.53 117.235L205.03 69.5332L221.529 117.235H188.53Z" fill="black"/>
                <path d="M343.069 121.483L291.283 43.0686H268.412V157.26H291.283V79.0081L343.069 157.26H365.94V43.0686H343.069V121.483Z" fill="black"/>
                <path d="M419.602 67.0015C424.773 63.8971 430.682 62.3456 437.327 62.3456C443.535 62.3456 449.007 63.708 453.745 66.4286C458.482 69.1535 462.158 73.2365 464.772 78.682H491.074C487.26 67.1391 480.562 58.0981 470.979 51.5633C461.395 45.0291 450.233 41.7617 437.49 41.7617C426.599 41.7617 416.768 44.2403 408.003 49.1947C399.235 54.1513 392.32 61.0664 387.256 69.9423C382.192 78.8196 379.66 88.8667 379.66 100.081C379.66 111.3 382.192 121.319 387.256 130.141C392.32 138.962 399.235 145.852 408.003 150.807C416.768 155.762 426.599 158.24 437.49 158.24C450.34 158.24 461.53 154.999 471.061 148.519C480.59 142.041 487.26 132.974 491.074 121.319H464.772C462.158 126.766 458.482 130.876 453.745 133.652C449.007 136.43 443.535 137.819 437.327 137.819C430.682 137.819 424.773 136.267 419.602 133.162C414.428 130.058 410.397 125.647 407.513 119.929C404.626 114.212 403.183 107.596 403.183 100.081C403.183 92.4593 404.626 85.8151 407.513 80.1516C410.398 74.491 414.428 70.1045 419.602 67.0015Z" fill="black"/>
                <path d="M585.904 49.1123C577.026 44.1042 567.199 41.5974 556.417 41.5974C545.742 41.5974 535.941 44.1042 527.012 49.1123C518.08 54.1231 511.002 61.0665 505.775 69.9417C500.547 78.8196 497.933 88.8103 497.933 99.9192C497.933 111.137 500.547 121.184 505.775 130.058C511.001 138.936 518.08 145.88 527.012 150.887C535.941 155.898 545.742 158.401 556.417 158.401C567.089 158.401 576.892 155.897 585.822 150.887C594.751 145.879 601.803 138.936 606.978 130.058C612.149 121.184 614.738 111.137 614.738 99.9192C614.738 88.8103 612.149 78.8196 606.978 69.9417C601.803 61.0672 594.779 54.1231 585.904 49.1123ZM586.803 120.013C583.862 125.786 579.778 130.223 574.55 133.327C569.323 136.43 563.277 137.982 556.417 137.982C549.556 137.982 543.483 136.431 538.202 133.327C532.919 130.223 528.809 125.786 525.869 120.013C522.929 114.241 521.458 107.543 521.458 99.92C521.458 92.2971 522.929 85.6247 525.869 79.9069C528.81 74.1898 532.919 69.8069 538.202 66.7568C543.483 63.7081 549.556 62.182 556.417 62.182C563.278 62.182 569.323 63.7081 574.55 66.7568C579.778 69.8069 583.862 74.1898 586.803 79.9069C589.743 85.6247 591.213 92.2971 591.213 99.92C591.213 107.543 589.743 114.241 586.803 120.013Z" fill="black"/>
                <path d="M726.965 43.2314L690.7 128.017L654.432 43.2314H628.457V157.26H651.328V83.0932L682.04 157.26H699.357L729.906 83.0932V157.26H752.777V43.2314H726.965Z" fill="black"/>
                <path d="M70.0813 43.2314H47.2228V87.8909H70.0813V43.2314Z" fill="black"/>
                <path d="M70.0813 110.768H47.2228V157.259H70.0813V110.768Z" fill="black"/>
                <path d="M141.809 43.2314H118.951V87.8909H141.809V43.2314Z" fill="black"/>
                <path d="M141.809 87.8994H70.0813V110.757H141.809V87.8994Z" fill="#FC5E20"/>
                <path d="M141.809 110.768H118.951V157.259H141.809V110.768Z" fill="black"/>
            </svg>
        </a>

        <nav>
            <a href="#" style="font-weight: 600; font-size: 0.95rem;">Login</a>
        </nav>
    </header>

    <section class="text-hero">
        <h1 class="hero-title">AI ì—…ë¬´ íš¨ìœ¨ì„ ìœ„í•œ,<br>ê¸°íšì´ê´„ ë””ìì¸ ë¼ì´ë¸ŒëŸ¬ë¦¬</h1>
        <p class="hero-subtitle">ìµœì í™”ëœ ì›Œí¬í”Œë¡œìš°ì™€ ë””ìì¸ ìì‚°ì„ í•œê³³ì—ì„œ ê´€ë¦¬í•˜ì„¸ìš”.</p>
    </section>

    <div class="main-visual-full">
        <div class="visual-overlay"></div>
    </div>

    <div class="container">
        <div class="section-header-glass">
            <div class="section-title">Resources</div>
            <span class="section-badge">6 Items</span>
        </div>
        
        <div class="grid-wrapper">
            <div class="card">
                <div class="icon-box"><i class="ph ph-file-text"></i></div>
                <h3>ë³´ê³ ì„œ ì—ì…‹</h3>
                <p>AIê°€ ì œì•ˆí•˜ëŠ” ë ˆì´ì•„ì›ƒê³¼ í•¨ê»˜, ì „ë¬¸ì ì¸ ë³´ê³ ì„œë¥¼ ë¹ ë¥´ê²Œ ì‘ì„±í•  ìˆ˜ ìˆëŠ” ë””ìì¸ ì–‘ì‹ì…ë‹ˆë‹¤.</p>
            </div>
            <div class="card">
                <div class="icon-box"><i class="ph ph-palette"></i></div>
                <h3>ê·¸ë˜í”½ ë””ìì¸</h3>
                <p>ë°°ë„ˆ, SNS ì½˜í…ì¸ , í™ë³´ë¬¼ ì œì‘ì„ ìœ„í•´ ì¦‰ì‹œ í™œìš© ê°€ëŠ¥í•œ ê³ í€„ë¦¬í‹° ê·¸ë˜í”½ ì†ŒìŠ¤ ëª¨ìŒì…ë‹ˆë‹¤.</p>
            </div>
            <div class="card">
                <div class="icon-box"><i class="ph ph-files"></i></div>
                <h3>ë¬¸ì„œ í…œí”Œë¦¿</h3>
                <p>ê¸°íšì„œ, ì œì•ˆì„œ, íšŒì˜ë¡ ë“± ì‹¤ë¬´ í‘œì¤€ì— ë§ì¶˜ ë‹¤ì–‘í•œ í¬ë§·ì˜ ë¬¸ì„œ í…œí”Œë¦¿ì…ë‹ˆë‹¤.</p>
            </div>
            <div class="card">
                <div class="icon-box"><i class="ph ph-shapes"></i></div>
                <h3>ì•„ì´ì½˜ ì—ì…‹</h3>
                <p>ì§ê´€ì ì¸ UIì™€ ì¸í¬ê·¸ë˜í”½ êµ¬ì„±ì„ ë„ì™€ì£¼ëŠ” ë‹¤ì–‘í•œ ìŠ¤íƒ€ì¼ì˜ ë²¡í„° ì•„ì´ì½˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ì…ë‹ˆë‹¤.</p>
            </div>
            <div class="card">
                <div class="icon-box"><i class="ph ph-chart-bar"></i></div>
                <h3>ë°ì´í„° ì‹œê°í™” ìë£Œ</h3>
                <p>ë³µì¡í•œ ìˆ˜ì¹˜ë¥¼ í•œëˆˆì— íŒŒì•…í•  ìˆ˜ ìˆë„ë¡ ë•ëŠ” ì°¨íŠ¸, ë„í‘œ ë° ì¸í¬ê·¸ë˜í”½ ë””ìì¸ í‚·ì…ë‹ˆë‹¤.</p>
            </div>
            <div class="card">
                <div class="icon-box"><i class="ph ph-folder-open"></i></div>
                <h3>ê¸°íƒ€ ìë£Œ</h3>
                <p>í°íŠ¸ ê°€ì´ë“œ, ë¡œê³  íŒŒì¼, ë¸Œëœë“œ ì»¬ëŸ¬ íŒ”ë ˆíŠ¸ ë“± ì—…ë¬´ì— í•„ìš”í•œ ëª¨ë“  ì¶”ê°€ ë¦¬ì†ŒìŠ¤ì…ë‹ˆë‹¤.</p>
            </div>
        </div>
    </div>

    <footer>
        &copy; 2026 ì „ëµì§€ì›íŒ€. All rights reserved.
    </footer>

    <div class="chat-tooltip" id="chatTooltip">
        ì±„íŒ…ì„ í™œì„±í™” í•´ë³´ì„¸ìš”!
    </div>

    <div class="chat-launcher" onclick="toggleChat()">
        <i class="ph ph-chat-teardrop-text"></i>
        <span class="notification-badge" id="notificationBadge">0</span>
    </div>

    <div class="chat-container" id="chatContainer">
        <div class="chat-header">
            <span>Team Chat</span>
            <div style="display: flex; align-items: center; gap: 10px;">
                <span class="chat-status">ğŸŸ¢ Online</span>
                <i class="ph ph-x chat-close-btn" onclick="toggleChat()"></i>
            </div>
        </div>

        <div class="login-screen" id="loginScreen">
            <h3>ëŒ€í™”ì— ì°¸ì—¬í•˜ì„¸ìš”</h3>
            <p style="font-size: 0.9rem; color: #64748b; margin-bottom: 20px;">íŒ€ì›ë“¤ê³¼ ì‹¤ì‹œê°„ìœ¼ë¡œ ì†Œí†µí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
            <input type="text" id="nicknameInput" class="login-input" placeholder="ë‹‰ë„¤ì„ (ë¯¸ì…ë ¥ì‹œ ìµëª…)">
            <button class="join-btn" onclick="joinChat()">ì°¸ì—¬í•˜ê¸°</button>
        </div>

        <div class="chat-body" id="chatBody"></div>

        <div class="chat-footer">
            <input type="text" id="messageInput" class="chat-input" placeholder="ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”..." onkeypress="handleKeyPress(event)">
            <button class="send-btn" onclick="sendMessage()"><i class="ph ph-paper-plane-right"></i></button>
        </div>
    </div>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, addDoc, onSnapshot, query, orderBy, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        // íŒŒì´ì–´ë² ì´ìŠ¤ ì„¤ì • (ì‚¬ìš©ì ì •ë³´ ìœ ì§€ë¨)
        const firebaseConfig = {
            apiKey: "AIzaSyClOSD1-ww8RzYTl9889V5TUALeYA0Msso",
            authDomain: "chat1team.firebaseapp.com",
            projectId: "chat1team",
            storageBucket: "chat1team.firebasestorage.app",
            messagingSenderId: "954158078055",
            appId: "1:954158078055:web:f935ef829ef7e24aa95cc2",
            measurementId: "G-5KQRHKPC89"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        let nickname = "ìµëª…ì˜ ì‚¬ìš©ì";
        let isChatOpen = false;
        let unreadCount = 0;
        let initialLoad = true; 

        // DOM ìš”ì†Œ ê°€ì ¸ì˜¤ê¸°
        const chatContainer = document.getElementById('chatContainer');
        const chatBody = document.getElementById('chatBody');
        const loginScreen = document.getElementById('loginScreen');
        const nicknameInput = document.getElementById('nicknameInput');
        const messageInput = document.getElementById('messageInput');
        const chatTooltip = document.getElementById('chatTooltip');
        const notificationBadge = document.getElementById('notificationBadge');

        // ğŸ”¥ ìˆ˜ì •ëœ ìš•ì„¤ í•„í„°ë§ í•¨ìˆ˜ (badwords.jsì—ì„œ ë°ì´í„°ë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ ê°€ì ¸ì˜´)
        function filterBadWords(text) {
            // ì±„íŒ…ì„ ë³´ë‚´ëŠ” ìˆœê°„ì— ë¦¬ìŠ¤íŠ¸ë¥¼ í™•ì¸ (ë‹¤ìš´ë¡œë“œê°€ ëŠ¦ì–´ë„ ë¬¸ì œ ì—†ìŒ)
            const currentList = window.badWordsList || [];
            
            let cleanText = text;
            
            // ëª¨ë“  ìš•ì„¤ì„ ëŒë©° ê²€ì‚¬
            currentList.forEach(word => {
                // ë‹¨ì–´ê°€ í¬í•¨ë˜ì–´ ìˆë‹¤ë©´?
                if (cleanText.includes(word)) {
                    // ë‹¨ì–´ ê¸¸ì´ë§Œí¼ ë³„í‘œ ìƒì„±
                    const stars = "*".repeat(word.length);
                    // ë‹¨ì–´ë¥¼ ë³„í‘œë¡œ êµì²´ (split/joinì€ íŠ¹ìˆ˜ë¬¸ì ì˜¤ë¥˜ê°€ ì•ˆ ë‚¨)
                    cleanText = cleanText.split(word).join(stars);
                }
            });
            return cleanText;
        }

        window.toggleChat = function() {
            chatContainer.classList.toggle('active');
            isChatOpen = chatContainer.classList.contains('active');

            if (isChatOpen) {
                chatTooltip.classList.add('hidden');
                unreadCount = 0;
                updateBadge();
                setTimeout(() => chatBody.scrollTop = chatBody.scrollHeight, 100);

                if (!loginScreen.classList.contains('hidden')) {
                    nicknameInput.focus();
                } else {
                    messageInput.focus();
                }
            } else {
                chatTooltip.classList.remove('hidden');
            }
        }

        window.joinChat = function() {
            const val = nicknameInput.value.trim();
            if(val) nickname = val;
            loginScreen.classList.add('hidden');
        }

        window.sendMessage = async function() {
            const text = messageInput.value.trim();
            if (!text) return;

            // âœ… ì—¬ê¸°ì„œ í•„í„°ë§ í•¨ìˆ˜ë¥¼ í†µê³¼ì‹œí‚´
            const filteredText = filterBadWords(text);

            try {
                // í•„í„°ë§ëœ ë©”ì‹œì§€(filteredText)ë¥¼ ì „ì†¡
                await addDoc(collection(db, "chats"), {
                    text: filteredText,
                    sender: nickname,
                    timestamp: serverTimestamp()
                });
                messageInput.value = '';
                messageInput.focus();
            } catch (e) {
                console.error("Error adding document: ", e);
                alert("ë©”ì‹œì§€ ì „ì†¡ ì‹¤íŒ¨!");
            }
        }

        window.handleKeyPress = function(e) {
            if (e.key === 'Enter') sendMessage();
        }

        function updateBadge() {
            if (unreadCount > 0) {
                notificationBadge.innerText = unreadCount > 9 ? '9+' : unreadCount;
                notificationBadge.classList.add('show');
            } else {
                notificationBadge.classList.remove('show');
            }
        }

        const q = query(collection(db, "chats"), orderBy("timestamp", "asc"));
        
        onSnapshot(q, (snapshot) => {
            snapshot.docChanges().forEach((change) => {
                if (change.type === "added") {
                    const data = change.doc.data();
                    const msgDiv = document.createElement('div');
                    
                    const isMyMsg = data.sender === nickname;
                    msgDiv.className = `message ${isMyMsg ? 'my-msg' : 'other-msg'}`;
                    
                    if (!isMyMsg) {
                        msgDiv.innerHTML = `<span class="message-info">${data.sender}</span>${data.text}`;
                        if (!isChatOpen && !initialLoad) {
                            unreadCount++;
                            updateBadge();
                        }
                    } else {
                        msgDiv.innerText = data.text;
                    }

                    chatBody.appendChild(msgDiv);
                    chatBody.scrollTop = chatBody.scrollHeight;
                }
            });
            initialLoad = false;
        });
    </script>
</body>
</html>