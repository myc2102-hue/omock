<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì»¤í”¼ìš”ì •ì°°ìŠ¤ - ì‹¤ì‹œê°„ ê³µë™ ì£¼ë¬¸</title>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-database-compat.js"></script>
    <style>
        :root { --primary: #6f4e37; --ice: #007bff; --hot: #dc3545; --bg: #fdfaf7; }
        body { font-family: 'Pretendard', sans-serif; background: var(--bg); margin: 0; padding: 20px; color: #333; line-height: 1.6; }
        .container { max-width: 480px; margin: 0 auto; background: white; padding: 25px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.08); }
        
        h1 { text-align: center; color: var(--primary); margin-bottom: 5px; }
        .status { text-align: center; font-size: 0.85rem; color: #888; margin-bottom: 25px; }

        /* ë©”ë‰´ ìŠ¤íƒ€ì¼ */
        .menu-item { border-bottom: 1px solid #f0f0f0; padding: 18px 0; }
        .menu-name { font-size: 1.1rem; font-weight: 700; margin-bottom: 12px; display: block; }
        .btn-group { display: flex; gap: 10px; }
        button { flex: 1; padding: 12px; border: none; border-radius: 12px; cursor: pointer; font-weight: bold; transition: 0.2s; font-size: 1rem; }
        
        .btn-ice { background: #eef6ff; color: var(--ice); border: 1px solid #cce3ff; }
        .btn-ice:hover { background: var(--ice); color: white; }
        .btn-hot { background: #fff5f5; color: var(--hot); border: 1px solid #ffe3e3; }
        .btn-hot:hover { background: var(--hot); color: white; }
        
        input[type="text"] { width: 100%; padding: 12px; margin-bottom: 12px; border: 2px solid #eee; border-radius: 12px; box-sizing: border-box; font-size: 1rem; outline: none; }
        input[type="text"]:focus { border-color: var(--primary); }

        /* ì£¼ë¬¸ ë‚´ì—­ ì„¹ì…˜ (ê°€ë¦¼ í˜„ìƒ ìˆ˜ì •) */
        .order-summary { margin-top: 30px; background: #fff; padding: 20px; border-radius: 15px; border: 2px solid var(--primary); position: relative; }
        .summary-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 2px solid #eee; }
        .summary-header h2 { font-size: 1.2rem; margin: 0; color: var(--primary); }
        
        /* ì´ˆê¸°í™” ë²„íŠ¼ì„ í—¤ë” ì•ˆìœ¼ë¡œ ë„£ì–´ ê°€ë¦¼ ë°©ì§€ */
        .btn-reset { flex: none; width: auto; padding: 6px 12px; font-size: 0.85rem; background: #f8f9fa; color: #666; border: 1px solid #ddd; border-radius: 6px; }
        .btn-reset:hover { background: #fee2e2; color: #dc3545; border-color: #fca5a5; }

        #order-list { list-style: none; padding: 0; margin: 0; max-height: 300px; overflow-y: auto; }
        .order-item { display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px dashed #eee; }
        
        .total-section { text-align: right; font-size: 1.25rem; color: var(--primary); font-weight: 800; margin-top: 15px; padding-top: 10px; border-top: 2px solid #eee; }
    </style>
</head>
<body>

<div class="container">
    <h1>â˜• ì°°ìŠ¤ëŠ”ì»¤í”¼ìš”ì • ì£¼ë¬¸</h1>
    <p class="status">ì „ì²´ ì‚¬ìš©ìê°€ ì‹¤ì‹œê°„ìœ¼ë¡œ ì£¼ë¬¸ì„ ê³µìœ í•©ë‹ˆë‹¤.</p>

    <div class="menu-item">
        <span class="menu-name">ì•„ë©”ë¦¬ì¹´ë…¸</span>
        <div class="btn-group">
            <button class="btn-ice" onclick="updateOrder('ì•„ë©”ë¦¬ì¹´ë…¸', 'Ice')">Ice</button>
            <button class="btn-hot" onclick="updateOrder('ì•„ë©”ë¦¬ì¹´ë…¸', 'Hot')">Hot</button>
        </div>
    </div>

    <div class="menu-item">
        <span class="menu-name">ë¼ë–¼</span>
        <div class="btn-group">
            <button class="btn-ice" onclick="updateOrder('ë¼ë–¼', 'Ice')">Ice</button>
            <button class="btn-hot" onclick="updateOrder('ë¼ë–¼', 'Hot')">Hot</button>
        </div>
    </div>

    <div class="menu-item">
        <span class="menu-name">ê¸°íƒ€ ë©”ë‰´ ì§ì ‘ ì…ë ¥</span>
        <input type="text" id="etc-name" placeholder="ë©”ë‰´ëª…ì„ ì…ë ¥í•˜ì„¸ìš” (ì˜ˆ: ìœ ìì°¨)">
        <div class="btn-group">
            <button class="btn-ice" onclick="updateEtcOrder('Ice')">Ice</button>
            <button class="btn-hot" onclick="updateEtcOrder('Hot')">Hot</button>
        </div>
    </div>

    <div class="order-summary">
        <div class="summary-header">
            <h2>ì£¼ë¬¸ ë‚´ì—­ ğŸ›’</h2>
            <button class="btn-reset" onclick="clearAllOrders()">ì „ì²´ ì´ˆê¸°í™” ğŸ”„</button>
        </div>
        <ul id="order-list">
            </ul>
        <div class="total-section">
            ì´ ìˆ˜ëŸ‰: <span id="total-count">0</span>ê°œ
        </div>
    </div>
</div>

<script>
    // âœ… ì‚¬ìš©ìê°€ ì œê³µí•œ Firebase ì„¤ì • ì ìš©
    const firebaseConfig = {
        apiKey: "AIzaSyBSxM3W_RkCt8poqQJxVhIgYMPqLuZgT6Y",
        authDomain: "menusame-6a326.firebaseapp.com",
        databaseURL: "https://menusame-6a326-default-rtdb.firebaseio.com",
        projectId: "menusame-6a326",
        storageBucket: "menusame-6a326.firebasestorage.app",
        messagingSenderId: "822750462446",
        appId: "1:822750462446:web:1cc67bd3f2b49e52670eff"
    };

    // Firebase ì´ˆê¸°í™”
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    const orderRef = db.ref('orders');

    // 1. ì£¼ë¬¸ ì¶”ê°€/ìˆ˜ëŸ‰ ì¦ê°€ (Transaction ì‚¬ìš©ìœ¼ë¡œ ì¶©ëŒ ë°©ì§€)
    function updateOrder(name, option) {
        const itemKey = `${name} (${option})`;
        orderRef.child(itemKey).transaction((currentValue) => {
            return (currentValue || 0) + 1;
        });
    }

    // 2. ê¸°íƒ€ ë©”ë‰´ ì¶”ê°€
    function updateEtcOrder(option) {
        const input = document.getElementById('etc-name');
        const name = input.value.trim();
        if (!name) {
            alert("ë©”ë‰´ëª…ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”!");
            input.focus();
            return;
        }
        updateOrder(name, option);
        input.value = ""; // ì…ë ¥ì°½ ì´ˆê¸°í™”
    }

    // 3. ì „ì²´ ì´ˆê¸°í™”
    function clearAllOrders() {
        if (confirm("ì •ë§ë¡œ ëª¨ë“  ì£¼ë¬¸ ë‚´ì—­ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\nì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìœ¼ë©° ëª¨ë“  ì‚¬ìš©ìì—ê²Œ ì ìš©ë©ë‹ˆë‹¤.")) {
            orderRef.remove();
        }
    }

    // 4. ì‹¤ì‹œê°„ ë°ì´í„° ìˆ˜ì‹  ë° í™”ë©´ ë Œë”ë§
    orderRef.on('value', (snapshot) => {
        const orders = snapshot.val() || {};
        const listElement = document.getElementById('order-list');
        const totalCountElement = document.getElementById('total-count');
        
        listElement.innerHTML = "";
        let total = 0;

        const keys = Object.keys(orders);
        if (keys.length === 0) {
            listElement.innerHTML = '<p style="text-align:center; color:#aaa; margin: 20px 0;">ì£¼ë¬¸ ë‚´ì—­ì´ ë¹„ì–´ ìˆìŠµë‹ˆë‹¤.</p>';
        } else {
            keys.forEach(key => {
                const count = orders[key];
                const li = document.createElement('li');
                li.className = 'order-item';
                li.innerHTML = `<span>${key}</span> <strong>${count}ê°œ</strong>`;
                listElement.appendChild(li);
                total += count;
            });
        }
        totalCountElement.innerText = total;
    });
</script>

</body>
</html>
